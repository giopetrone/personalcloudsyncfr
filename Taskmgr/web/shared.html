<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<title>
Share The Diagram
</title>

<!-- Meta Tags -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Wufoo.com" />

<!-- CSS -->
<link rel="stylesheet" href="./css/structure.css" type="text/css" />
<link rel="stylesheet" href="./css/form.css" type="text/css" />
<link type="text/css" rel="stylesheet" href="./css/dhtmlgoodies_calendar.css?random=20051112" media="screen"></link>
<!-- JavaScript -->
<script type="text/javascript" src="./scripts/wufoo.js"></script>

<script type="text/javascript" src="./js/dhtmlgoodies_calendar.js?random=20060118"></script>
<script type="text/javascript">
/*
 * Retrieve all contacts
 */
var users = new Array();

function privilege()
{
    var user = parent.document.getElementById("owner").value;
    var readers = parent.document.getElementById("users").value
    var writers = parent.document.getElementById("writers").value;
    var own = TextEdit.target.parentNode.parentNode.parentNode.owner;

}


function initShare(oForm, element_name) {

frmElement = oForm.elements[element_name];
frmElement.value = opener.document.getElementById('users').value;




}
function setArray(recipients)
{
   
    users = recipients;
    opener.setArray(recipients);
    return users;
}


function setUsers()
{
    try
    {

        var chosenusers = document.getElementById("share").value;
        var chosenusersarray = chosenusers.split(",");
        var assignees = opener.document.getElementById("assignees").value;
        for(var j=0;j<chosenusersarray.length;j++)
        {
            var value = chosenusersarray[j];
            var lungh = value.length;
            if(value.match(" ")) value = value.substring(1,lungh);
            if(value != "" && assignees.match(value) == null)
            {
                opener.document.getElementById('writers').value += ","+value;
            }
        }
    }catch(e){alert(e.message);}
  //  opener.document.getElementById('writers').value = document.getElementById("share").value;
    opener.document.getElementById('users').value = "";
    self.close();
    return false;

}


 function append()
      {
          
        var size = users.length;
       
        var add = document.getElementById("append");
        

            while (add.firstChild) {
              add.removeChild(add.firstChild);
            }


            for(var i=0;i<size;i++)
            {
                 var cb = document.createElement( "input" );
                 var value = users[i];
                 cb.type = "checkbox";
                 cb.id = value;
                 cb.value = value;
                 cb.checked = false;
                 cb.name = "checkgroup";
                 var text = document.createTextNode( value);
                 var br = document.createElement("br");
                 
                 add.appendChild(cb);
                 add.appendChild(text);
                 
                 add.appendChild(br);
                
            }
        
     
      }


      function check()
      {
          var checked = new Array();
          var y =0;
          
          var z = document.myform.checkgroup;
          if(z == null) return;
          for (i=0; i<document.myform.checkgroup.length; i++){
            if (document.myform.checkgroup[i].checked==true){
               checked[y] = document.myform.checkgroup[i].value;
               y++;
            }

          }
          var emailRecipientsString = '';
          for (var i = 0; i < checked.length; i++) {
            var recipient = checked[i];
            emailRecipientsString += recipient + ',';
          }
          //emailRecipientsString = emailRecipientsString.substring(0, emailRecipientsString.length - 2);
          opener.document.getElementById('writers').value = emailRecipientsString;
          

      }




</script>
</head>

<body id="public" onload="initShare(document.forms[0], 'share');">
<div id="container">



<form name='myform'>


	<h2>Share this diagram with users</h2>

        <h4>These users will be able to save and modify the diagram</h4>



<ul>




 <li >
            <label class="desc" id="title2" for="Field2">
		Diagram Shared with
			</label>
        <input type="text"  id="share" name="share"  />
        <a href="#" onclick="childWindow=open('newhtml.html','_blank','status=1,toolbar=1,scrollbars=1,width=600,height=800')" id="add" name="add" >Import users from gmail </a>
    </li>






	<li class="buttons ">
		<div>

                    <input type="button" name="ok" value="Ok"    id="ok"  onclick="setUsers()"/>
	<input type="button" name="reset" value="Cancella" onclick="opener.cleanArray();self.close();"/>

				</div>
	</li>


</ul>
</form>

</div><!--container-->

</body>
</html>